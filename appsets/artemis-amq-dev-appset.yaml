apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: artemis-amq-dev-appset
  namespace: argocd
spec:
  goTemplate: true
  goTemplateOptions: ["missingkey=error"]
  generators:
    - git:
      repoURL:
      revision: HEAD
      directories:
        - path: apps/*/envs/dev
  template:
  metadata:
    name: '{{index .path.segments 1}}-{{index .path.segments 3}}'
  spec:
    project: default
    source:
      repoURL: https://something
      targetRevision: HEAD
      path: '{{.path.path}}'
    destination:
      server: https://something
      namespace: '{{index .path.segments 1}}-{{index.path.segments 3}}'
